View(dfs_1000[1])
View(dfs_500[1])
create_df_500 <- function(a){
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(a[1] + a[2]*x_500 >= eps0_500 - eps1_500, 1, 0)
return(data.frame(x_500, d_500))
}
dfs_500 <- lapply(rep(list(c(alpha_0,alpha_1)),100), create_df_500)
create_df_1000 <- function(a){
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(a[1] + a[2]*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
return(data.frame(x_1000, d_1000))
}
dfs_1000 <- lapply(rep(list(c(alpha_0,alpha_1)),100), create_df_1000)
View(dfs_500[1])
View(dfs_1000[1])
for (i in 1:500) {
dfs_500 <- list()
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(a[1] + a[2]*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
for (i in 1:500) {
dfs_500 <- list()
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
dfs_500 <- lapply(rep(list(c(alpha_0,alpha_1)),100), create_df_500)
dfs_500
View(dfs_500)
for (i in 1:1000) {
dfs_1000 <- list()
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(a[1] + a[2]*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000 <- data.frame(x_1000, d_1000)
}
for (i in 1:1000) {
dfs_1000 <- list()
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(alpha_0 + alpha_1*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000 <- data.frame(x_1000, d_1000)
}
dfs_1000 <- lapply(rep(list(c(alpha_0,alpha_1)),100), create_df_1000)
dfs_1000
View(dfs_1000[1])
View(dfs_500[1])
# Defining the parameters
alpha_0 <- 0.8
alpha_1 <- 0.7
for (i in 1:500) {
dfs_500 <- list()
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
dfs_500
for (i in 1:1000) {
dfs_1000 <- list()
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(alpha_0 + alpha_1*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000 <- data.frame(x_1000, d_1000)
}
dfs_1000
View(dfs_500[1])
View(dfs_1000)
for (i in 1:500) {
dfs_500 <- list()
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
dfs_500
View(dfs_500)
list()
vector("list", 500)
for (i in 1:500) {
dfs_500 <- vector("list", 500)
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
# Defining the parameters
alpha_0 <- 0.8
alpha_1 <- 0.7
for (i in 1:500) {
dfs_500 <- vector("list", 500)
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
View(dfs_500)
for (i in 1:500) {
dfs_500 <- vector("list", 500)
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[[i]] <- data.frame(x_500, d_500)
}
View(dfs_500)
list()
list[1]
list(rep(0,500))
list(rep(0,500))[1] < 2
list(rep(0,500))[1] <- 2
list(rep(0,500))[1]
append(list(), 1)
for (i in 1:500) {
dfs_500 <- list()
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
append(dfs_500, data.frame(x_500, d_500))
}
dfs_500
dfs_500 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
append(dfs_500, data.frame(x_500, d_500))
}
dfs_500
dfs_500 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500 <- data.frame(x_500, d_500)
}
View(dfs_500)
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[i] <- data.frame(x_500, d_500)
}
View(dfs_500)
dfs_500 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[[i]] <- data.frame(x_500, d_500)
}
View(dfs_500)
dfs_1000 <- list()
dfs_1000 <- list()
for (i in 1:1000) {
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(alpha_0 + alpha_1*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000[[i]] <- data.frame(x_1000, d_1000)
}
dfs_1000
View(dfs_1000)
dfs_1000[1]
View(dfs_1000[1])
View(dfs_1000[[1]])
View(dfs_1000[[1]]$x_1000)
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
#optim(c(0.75,0.8), alpha_SMM, fn=alpha_SMM_500)
results_500 <- lapply(rep(list(c(0.75,0.8)), 100), optim, fn=alpha_SMM)
}
full_estimator_500(dfs_500[[1]])
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
#optim(c(0.75,0.8), alpha_SMM, fn=alpha_SMM_500)
results_500 <- lapply(rep(list(c(0.75,0.8)), 100), optim, fn=alpha_SMM_500)
}
full_estimator_500(dfs_500[[1]])
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM))
}
full_estimator_500(dfs_500[[1]])
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM_500))
}
full_estimator_500(dfs_500[[1]])
typeof(dfs_500)
dfs_500[1]
View(dfs_500[1])
typeof(dfs_500[1])
unlist(dfs_500[1])
View(unlist(dfs_500[1]))
View(dfs_500[[1])
View(dfs_500[[1]])
Unlist(dfs_500[1])
unlist(dfs_500[1])
View(unlist(dfs_500[1]))
dfs_500
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM_500))
}
results_500 <- lapply(dfs_500, optim, fn=full_estimator_500)
View(unlist(dfs_500))
View(dfs_500)
View(dfs_500[1])
View(dfs_500[[1]])
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM_500))
}
results_500 <- lapply(dfs_500, optim, fn=full_estimator_500)
results_500 <- apply(dfs_500, optim, fn=full_estimator_500)
results_500 <- map_dbl(dfs_500, optim, fn=full_estimator_500)
results_500 <- map(dfs_500, optim, fn=full_estimator_500)
list(c(1,2,3))
list(1,2,3
list(1,2,3
list(1,2,3)
list(c(1,2,3))
list(c(1,2,3))[1]
dfs_500 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[[i]] <- cbind(x_500, d_500)
}
dfs_500
View(dfs_500)
View(dfs_500[1])
View(dfs_500)
View(dfs_500[1])
dfs_500 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[[i]] <- data.frame(x_500, d_500)
}
View(dfs_500)
dfs_1000 <- list()
for (i in 1:1000) {
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(alpha_0 + alpha_1*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000[[i]] <- data.frame(x_1000, d_1000)
}
View(dfs_1000)
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df$x_500, simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df$x_500, df$d_500)) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM_500))
}
results_500 <- lapply(dfs_500, optim, fn=full_estimator_500)
View(dfs_500)
dfs_500 <- list()
dfs_1000 <- list()
for (i in 1:500) {
x_500 <- rlnorm(500,meanlog=5, sdlog=sqrt(3))
eps0_500 <- rgumbel(500)
eps1_500 <- rgumbel(500)
d_500 <- ifelse(alpha_0 + alpha_1*x_500 >= eps0_500 - eps1_500, 1, 0)
dfs_500[[i]] <- cbind(x_500, d_500)
}
for (i in 1:1000) {
x_1000 <- rlnorm(1000,meanlog=5, sdlog=sqrt(3))
eps0_1000 <- rgumbel(1000)
eps1_1000 <-rgumbel(1000)
d_1000 <- ifelse(alpha_0 + alpha_1*x_1000 >= eps0_1000 - eps1_1000, 1, 0)
dfs_1000[[i]] <- cbind(x_1000, d_1000)
}
df_500[[1]]
dfs_500[[1]]
View(dfs_500[[1]])
View(dfs_500[[1]]$x_500)
View(dfs_500[[1]][1])
View(dfs_500[[1]])
View(dfs_500[[1]]["x_500"])
View(dfs_500[[1]])
View(dfs_500[[1,1]])
View(dfs_500[[1],1])
View(dfs_500[[1]])
View(dfs_500[[,1]])
View(dfs_500[[1]][1,])
View(dfs_500[[1]][,1])
View(dfs_500[[1]])
full_estimator_500 <- function(df) {
m_500 <- function(a){
simul_eps0_500 <- rgumbel(500)
simul_eps1_500 <- rgumbel(500)
simul_d <- ifelse(a[1] + a[2]*x_500 >= simul_eps0_500 - simul_eps1_500, 1, 0)
d_mean <- mean(simul_d)
cov_x_d <- cov(df[,1], simul_d)
return(c(d_mean, cov_x_d))
}
alpha_SMM_500 <- function(alpha){
simul_sample_mean <- Reduce(`+`, lapply(rep(list(c(alpha[1], alpha[2])),30), m_500))/30
A <- c(mean(d_500), cov(df[,1], df[,2])) - simul_sample_mean
I <- diag(2)
return(t(A) %*% solve(I) %*% A)
}
return(optim(c(0.75,0.8), alpha_SMM_500))
}
results_500 <- lapply(dfs_500, optim, fn=full_estimator_500)
View(dfs_500[1][,1])
View(dfs_500[1])
View(unlist(dfs_500[1])
a
View(unlist(dfs_500[1]))
dfs_500[1]
View(dfs_500[1])
results_500 <- lapply(dfs_500, full_estimator_500)
View(results_500)
results_500$par
results_500[[1]]$par
results_500[[1]]$par
results_500[[1]]$par[1]
alphas_0_SMM <- list()
for(i in 1:100) {
alphas_0_SMM[i] <- results_500[[i]]$par[i]
}
alphas_0_SMM
results_500[[1]]$par[1]
alphas_0_SMM <- list()
for(i in 1:100) {
alphas_0_SMM[[i]] <- results_500[[i]]$par[i]
}
alphas_0_SMM
1:100
results_500[[20]]$par[20]
alphas_0_SMM <- list()
for(i in 1:100) {
alphas_0_SMM[[i]] <- results_500[[i]]$par[1]
}
alphas_0_SMM
mean(alphas_0_SMM)
alphas_0_SMM
alphas_0_SMM <- list()
for(i in 1:100) {
alphas_0_SMM[i] <- results_500[[i]]$par[1]
}
alphas_0_SMM
mean(alphas_0_SMM)
alphas_0_SMM <- list()
for(i in 1:100) {
alphas_0_SMM[i] <- results_500[[i]]$par[1]
}
alphas_0_SMM
unlist(alphas_0_SMM)
mean(unlist(alphas_0_SMM))
alphas_1_SMM <- list()
for(i in 1:100) {
alphas_1_SMM[i] <- results_500[[i]]$par[2]
}
mean(unlist(alphas_1_SMM))
alphas_0_SMM_500 <- list()
for(i in 1:100) {
alphas_0_SMM_500[i] <- results_500[[i]]$par[1]
}
mean(unlist(alphas_0_SMM))
mean_alphas_0_SMM_500 <- mean(unlist(alphas_0_SMM))
alphas_1_SMM_500 <- list()
for(i in 1:100) {
alphas_1_SMM_500[i] <- results_500[[i]]$par[2]
}
mean(unlist(alphas_1_SMM))
mean_alphas_1_SMM_500 <- mean(unlist(alphas_1_SMM))
mean_alphas_1_SMM_500
msqe <- mean((alphas_0_SMM_500 - alpha_0)^2)
alphas_0_SMM_500
alpha_0
alphas_0_SMM_500 - alpha_0
msqe <- mean((alphas_0_SMM_500 - rep(alpha_0, 100))^2)
rep(alpha_0, 100)
alphas_0_SMM_500
unlist(alphas_0_SMM_500) - alpha_0
(unlist(alphas_0_SMM_500) - alpha_0)^2
msqe <- mean((unlist(alphas_0_SMM_500) - alpha_0)^2)
msqe
msqe_alphas_0 <- mean((unlist(alphas_0_SMM_500) - alpha_0)^2)
msqe_alphas_1 <- mean((unlist(alphas_1_SMM_500) - alpha_1)^2)
msqe_alphas_1
msqe_alphas_0 <- mean((unlist(alphas_0_SMM_500) - alpha_0)^2)
msqe_alphas_0
msqe_alphas_1
mean_alphas_1_SMM_500 <- var(unlist(alphas_1_SMM))
mean_alphas_1_SMM_500 <- mean(unlist(alphas_1_SMM))
var_alphas_1_SMM_500 <- var(unlist(alphas_1_SMM))
var_alphas_1_SMM_500
mean_alphas_0_SMM_500 <- mean(unlist(alphas_0_SMM))
var_alphas_0_SMM_500 <- var(unlist(alphas_0_SMM))
msqe_alphas_0 <- mean((unlist(alphas_0_SMM_500) - alpha_0)^2)
var_alphas_0_SMM_500
